Задача найти приросты по клиентским мнеджерам и по клиентам
задаем вариант поиска прироста по двум или по трем файлам
Задаем три или два файла в фомате excel и имя листа в каждом с которого будем забирать данные (зависит от параметра по двум или по трем)
суть по двум: прирост = показатель в фале 2 - показатель в файле 1
по трем: прирост = (файл 3 - файл 2) - (файл 2 - файл 1)

задаем назания колонок в каждом файле которые будем забирать для анализа:
Табельный номер КМ 
Имя КМ
ТБ
ГОСБ
Идентификатор клиента
Наименование клиента
Показатель

например
Tn: "Таб. номер"
FIO: "Фамилия"
TB: "коротко ТБ"
GOSB: "короткое наименование ГОСБ"
ID: "ЕПК ИД"
Client: "Наименование клиента"
Value: "СДО руб"

имя переменной будут у полей единые для всех таблиц - а вот имена колонок огут отличаться

задай данные для каждого файла в виде списка параметров в одном кортеже например или как удобнее и нашляднее для конфигурирования сделай

остальные поля в таблицах и не указанные листы игнорируй

задаем парамет брать закрепление на последнюю дату или на дату отчета

надо сформировать базу клиентв из уникальных Идентификатор клиента из всех трех или двух файлов

к этой базе надо добавить две или три кононки (зависит от числа файлов) с данными по "Табельный номер КМ" из каждого из файлов
если в каком-то из файлов отсуттсвует клиент или нет конкретного "Табельный номер КМ" в нем то надо присвоить табельный номер = 0

далее надо добавить три колонки с такими же данными из каждого файла с "Показатель" - если показателя в каком-то периоде нет - ставим 0

далее добавлем колонку с приростом рассчитанным по указанной выше формуле в зависимости от числа файлов

формируем итоговую колонку с табельным по логике - если есть в файле 3 то берем оттуда далее если в 3 нет берем из 2 если в 2 нет берем в 1 и если и там нет то ставим 0

далее отдельно собираем все Табельные уникальные

к этим табельным собираем приросты: по колонке итог табельный

выводим все даныне в новый файл эксель 
название задаем тоже в параметрах
там же задаем название двух листов - лист с клиентами и лист с табельными
задаем какие колонки выводим в каждом из листов
кстати название тн для каждого файла в новом файле и название показателей приростов и тд тоже задаем здесь и используем в программе

на листе с клиентми надо вывести Идентификатор клиента
Наименование клиента .Показатель 1 , Показатель2 ,Показатель3. прирост .табельный итоговый. фио итогового сотрудника. ГОСБ и ТБ
на листе к Км: Табельный уник, фио, ТБ, ГОСБ, Показатель 1 , Показатель2 ,Показатель3 (суммы по клиентам) и суммарный прирост 

для теста программы создай 3 файла excel с 500 клиентами в каждом, рандомные показатели но в большем файле больше знаение показателя 
табельные и фио бери с учетом смены их от файла к файлу на 15% различия

От файла к файлу идентификатор клиента у наждого будлет один и тот же
Табельных и ФИО пусть будет 1000 для примера
ТБ - 11
ГОСБ пусть по 5-10 в каждом ТБ

и на этих файлах будем тестировать программу




